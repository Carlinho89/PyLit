<?xml version="1.0" encoding="iso-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<meta name="generator" content="Docutils 0.4.1: http://docutils.sourceforge.net/" />
<title>Test the iterator wrappers from iterqueue.py</title>
<style type="text/css">

/*
:Author: David Goodger
:Contact: goodger@users.sourceforge.net
:Date: $Date: 2005-12-18 01:56:14 +0100 (Sun, 18 Dec 2005) $
:Revision: $Revision: 4224 $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin-left: 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left {
  clear: left }

img.align-right {
  clear: right }

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font-family: serif ;
  font-size: 100% }

pre.literal-block, pre.doctest-block {
  margin-left: 2em ;
  margin-right: 2em ;
  background-color: #eeeeee }

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

tt.docutils {
  background-color: #eeeeee }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="test-the-iterator-wrappers-from-iterqueue-py">
<h1 class="title">Test the iterator wrappers from iterqueue.py</h1>
<!-- #!/usr/bin/env python
# -*- coding: iso-8859-1 -*- -->
<div class="contents topic">
<p class="topic-title first"><a id="contents" name="contents">Contents</a></p>
<ul class="auto-toc simple">
<li><a class="reference" href="#get-and-sort-the-wrapper-classes" id="id1" name="id1">1&nbsp;&nbsp;&nbsp;Get and sort the wrapper classes</a></li>
<li><a class="reference" href="#test-wrappers" id="id2" name="id2">2&nbsp;&nbsp;&nbsp;Test Wrappers</a></li>
<li><a class="reference" href="#test-peekables" id="id3" name="id3">3&nbsp;&nbsp;&nbsp;Test Peekables</a></li>
<li><a class="reference" href="#test-pushables" id="id4" name="id4">4&nbsp;&nbsp;&nbsp;Test Pushables</a></li>
<li><a class="reference" href="#test-iterator-queue" id="id5" name="id5">5&nbsp;&nbsp;&nbsp;Test Iterator Queue</a></li>
<li><a class="reference" href="#test-state-reporters" id="id6" name="id6">6&nbsp;&nbsp;&nbsp;Test State Reporters</a></li>
</ul>
</div>
<pre class="literal-block">
import sys, itertools
import iterqueue
from iterqueue import *
</pre>
<div class="section">
<h1><a class="toc-backref" href="#id1" id="get-and-sort-the-wrapper-classes" name="get-and-sort-the-wrapper-classes">1&nbsp;&nbsp;&nbsp;Get and sort the wrapper classes</a></h1>
<p>List all iterator wrapper objects:</p>
<pre class="literal-block">
wrappers = [obj for obj in iterqueue.__dict__.values()
            if is_iterator_wrapper(obj)]
# print &quot;\n&quot;.join(repr(wrapper) for wrapper in wrappers)
</pre>
<p>List iterator wrappers that provide a <cite>peek</cite> method:</p>
<pre class="literal-block">
peekables = [obj for obj in wrappers if is_peekable(obj)]
# print &quot;Peekables&quot;
# print &quot;\n&quot;.join(repr(peekable) for peekable in peekables)
</pre>
<p>List iterator wrappers that provide a <cite>push</cite> method:</p>
<pre class="literal-block">
pushables = [obj for obj in wrappers if is_pushable(obj)]
# print &quot;Pushables&quot;
# print &quot;\n&quot;.join(repr(pushable) for pushable in pushables)
</pre>
<p>List iterator wrappers that provide a test for &quot;values available&quot;:</p>
<pre class="literal-block">
state_reporters = [obj for obj in wrappers if is_state_reporting(obj)]
# print &quot;State Reporters&quot;
# print &quot;\n&quot;.join(repr(state_reporter) for state_reporter in state_reporters)
</pre>
<p>List iterator wrappers that implement the &quot;queue&quot; methods:</p>
<pre class="literal-block">
iqueues = [obj for obj in wrappers if is_iterator_queue(obj)]
# print &quot;Iterator Queues&quot;
# print &quot;\n&quot;.join(repr(iqueue) for iqueue in iqueues)
</pre>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id2" id="test-wrappers" name="test-wrappers">2&nbsp;&nbsp;&nbsp;Test Wrappers</a></h1>
<p>Test the basic iterator features of an iterator wrapper.</p>
<pre class="literal-block">
class Test_Wrappers:
    &quot;&quot;&quot;Test the wrapping of iterator wrappers&quot;&quot;&quot;
    def wrap_ok(self, wrapper, base):
        &quot;&quot;&quot;iterating over the wrapper should return the same
        as iterating over base
        &quot;&quot;&quot;
        print wrapper
        assert list(wrapper(base)) == list(base)
        assert [i for i in wrapper(base)] == [i for i in base]

    def test_wrappers(self, base=xrange(3)):
        for wrapper in wrappers:
            yield self.wrap_ok, wrapper, base
</pre>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id3" id="test-peekables" name="test-peekables">3&nbsp;&nbsp;&nbsp;Test Peekables</a></h1>
<pre class="literal-block">
class Test_Peekables:
    &quot;&quot;&quot;Test the peek method of iterator wrappers&quot;&quot;&quot;
    def peek_ok(self, wrapper, base):
        &quot;&quot;&quot;peek() should return next value but not advance the iterator&quot;&quot;&quot;
        print wrapper
        print wrapper.peek
        it = wrapper(base)
        it.peek()
        first = it.peek()
        print first
        assert first == 0
        # peek() must not &quot;use up&quot; values
        result = list(it)
        print result
        assert result == list(base)

    def test_peekables(self, base=xrange(3)):
        &quot;&quot;&quot;Test generator for peekable iterator wrappers&quot;&quot;&quot;
        for wrapper in peekables:
            yield self.peek_ok, wrapper, base
</pre>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id4" id="test-pushables" name="test-pushables">4&nbsp;&nbsp;&nbsp;Test Pushables</a></h1>
<pre class="literal-block">
class Test_Pushables:
    &quot;&quot;&quot;Test the push method of iterator wrappers&quot;&quot;&quot;

    def push_ok(self, wrapper, base):
        &quot;&quot;&quot;push(value) shall prepend `value` to iterator&quot;&quot;&quot;
        print wrapper.push
        it = wrapper(base)
        it.push(9)
        result = list(it)
        print result
        assert result == [9] + list(base)

    def push_while_iterating_ok(self, wrapper):
        &quot;&quot;&quot;push shall work even in an iteration loop&quot;&quot;&quot;
        print wrapper
        it = wrapper(xrange(3))
        result = []
        for i in it:
            if i == 1:
                it.push(&quot;xx&quot;)
            result.append(i)
        assert result == [0, 1, 'xx', 2]

    def test_pushables(self, base=xrange(3)):
        &quot;&quot;&quot;Test generator for pushable iterator wrappers&quot;&quot;&quot;
        for wrapper in pushables:
            if not hasattr(wrapper, &quot;push&quot;):
                wrapper.push = wrapper.appendleft
            yield self.push_ok, wrapper, base
            yield self.push_while_iterating_ok, wrapper
</pre>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id5" id="test-iterator-queue" name="test-iterator-queue">5&nbsp;&nbsp;&nbsp;Test Iterator Queue</a></h1>
<pre class="literal-block">
class TestIteratorQueue:
    &quot;&quot;&quot;Test the queueing methods of iterator queues&quot;&quot;&quot;
    #
    def extend_ok(self, wrapper, base):
        &quot;&quot;&quot;extend(iterable) shall append `iterable` to iterator&quot;&quot;&quot;
        print wrapper
        it = wrapper(base)
        it.extend([9])
        assert list(it) == list(base) + [9]

    def extendleft_ok(self, wrapper, base):
        &quot;&quot;&quot;extendleft(iterable) shall prepend `iterable` to iterator&quot;&quot;&quot;
        print wrapper
        it = wrapper(base)
        it.extendleft([9])
        result = [i for i in it]
        print result
        assert result == [9] + list(base)

    def append_ok(self, wrapper, base):
        &quot;&quot;&quot;append(value) shall append `value` to iterator&quot;&quot;&quot;
        print wrapper
        it = wrapper(base)
        it.append(9)
        result = list(it)
        print result
        assert result == list(base) + [9]

    def test_iqueues(self, base=xrange(3)):
        &quot;&quot;&quot;Test generator for iterator-queue wrappers&quot;&quot;&quot;
        for wrapper in iqueues:
            yield self.extend_ok, wrapper, base
            yield self.extendleft_ok, wrapper, base
            yield self.append_ok, wrapper, base
</pre>
</div>
<div class="section">
<h1><a class="toc-backref" href="#id6" id="test-state-reporters" name="test-state-reporters">6&nbsp;&nbsp;&nbsp;Test State Reporters</a></h1>
<pre class="literal-block">
class Test_StateReporters:
    &quot;&quot;&quot;Test the state reporting when converted to bool&quot;&quot;&quot;
    def bool_ok(self, wrapper):
        &quot;&quot;&quot;Empty iterator should evaluate to False
           Non-empty iterator should evaluate to True
           the evaluation should not advance the iterator
           &quot;&quot;&quot;
        base = xrange(3) # make sure it is not empty!
        it0 = wrapper([])
        assert bool(it0) == False
        assert list(it0) == []
        it1 = wrapper(base)
        assert bool(it1) == True
        assert list(it1) == list(base)
        assert bool(wrapper(iter([]))) == False
        assert bool(wrapper(iter([1]))) == True

    def test_iqueues(self):
        &quot;&quot;&quot;Test generator for iterator-queue wrappers&quot;&quot;&quot;
        for wrapper in state_reporters:
            yield self.bool_ok, wrapper


if __name__ == &quot;__main__&quot;:
    import nose
    # this doesnot show any effect :-(
    nose.configure([&quot;test.py&quot;, &quot;--detailed-errors&quot;])
    nose.runmodule() # requires nose 0.9.1
</pre>
</div>
</div>
<div class="footer">
<hr class="footer" />
Generated on: 2007-02-22.

</div>
</body>
</html>
